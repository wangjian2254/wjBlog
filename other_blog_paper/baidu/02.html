<!DOCTYPE html><html  id="customDoc"><!--STATUS OK--> <head> <meta http-equiv=Content-Type content="text/html; charset=utf-8"> <title> 数据库物理模型设计_inJava_百度空间</title> <link rel="shortcut icon" href="http://hi.bdimg.com/static/qbase/img/mod/16_favicon.ico?v=116ba471.ico" type=image/x-icon>   <meta name=keywords content="数据库物理模型设计,数据库"> <meta name=description content="J2EE、架构、搜索引擎、数据挖掘、互联网、创业、媒体、资料库,数据库物理模型设计"><script>window.wpo={start:new Date*1,pid:109,page:'qing'}</script><!--[if IE]><script type="text/javascript">(function(){var a="abbr,article,aside,audio,canvas,datalist,details,dialog,eventsource,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(","),b=a.length;while(b--)document.createElement(a[b])})();</script><![endif]--><script>window.qDomain={"qing":"http://hi.baidu.com","static":"http://hi.bdimg.com","passport":"https://passport.baidu.com","portrait":"http://tx.bdimg.com","hiup":"http://hiup.baidu.com","photo":"http://hiphotos.baidu.com","message":"http://msg.baidu.com","friend":"http://frd.baidu.com","mp3":"http://mp3.baidu.com","ting":"http://ting.baidu.com","image":"http://img.baidu.com","qup":"http://upload.hi.baidu.com","www":"http://www.baidu.com"};window.qUserInfo={"userName":"macaque1101","nickname":"macaque1101","portrait":"1362696e6a6176619401","qingUrl":"\/injava","spaceName":"inJava","right":"0","avatarStatus":"1","flagNeedInvite":"0","flagNotInvited":"0","version":"2"};window.qVisitorInfo={"userName":"","nickname":"","portrait":"","isHost": false,"isRandUrl": false,"isForceMoved": false,"loginStatus":"not_login","isOldUser":0,"qingUrl":"","right":"0","version":"0"};window.qPageInfo={"pageUrl":"http:\/\/hi.baidu.com\/injava\/item\/9a852287bd2a062b110ef34a","referUrl":"http:\/\/hi.baidu.com\/injava\/item\/c40fcbd71c55fb2838f6f74a"};window.qUserAvatar={size20:"http://hiphotos.baidu.com/space/scrop=20;q=100/sign=adcb164e62d9f2d3244f63b0d9d1b823/83025aafa40f4bfb2dd2b7fb034f78f0f736181a.jpg",size40:"http://hiphotos.baidu.com/space/scrop=40;q=100/sign=b4e6ee4c572c11dfda8ff87c131a56e0/83025aafa40f4bfb2dd2b7fb034f78f0f736181a.jpg",size65:"http://hiphotos.baidu.com/space/scrop=65;q=100/sign=81130d40a9ec8a13104410bf873ea7ba/83025aafa40f4bfb2dd2b7fb034f78f0f736181a.jpg",size110:"http://hiphotos.baidu.com/space/scrop=110;q=100/sign=f700a4917bec54e745b25d41c905aa61/83025aafa40f4bfb2dd2b7fb034f78f0f736181a.jpg",size160:"http://hiphotos.baidu.com/space/scrop=160;q=100/sign=f700a4917bec54e745b25d41c905aa66/83025aafa40f4bfb2dd2b7fb034f78f0f736181a.jpg"};window.qVisitorAvatar={size20:"",size40:"",size65:"",size110:"",size160:""};window.qBdsToken="the fisrt two args should be string type:0,1!";window.qErrorInfo={"no":"0","msg":""};window.qServerInfo={"timeStamp":"1364521241"};window.qLongPolling={"url":"http:\/\/m.hi.baidu.com\/i\/msg\/listen"}</script><!--[if (lt IE 8.0)]><link href="http://hi.bdimg.com/static/qbase/css/qbase.css?v=888928d6.css" type=text/css rel=stylesheet><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link href="http://hi.bdimg.com/static/qbase/css/qbase_datauri.css?v=a2bd7844.css" type=text/css rel=stylesheet><!--<![endif]-->     <!--[if (lt IE 8.0)]><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qcomment/css/qcomment.css?v=5ba753ab.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qcomment/css/qcomment_datauri.css?v=a90beb01.css"><!--<![endif]--><link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qhome/css/common/mod_userInfo.css?v=86bf4259.css">    <!--[if (lt IE 8.0)]><link type=text/css rel=stylesheet href="http://hi.bdimg.com/static/qhome/css/detail/20002/detail.css?v=5eaa40ac.css"><![endif]--><!--[if (!IE)|(gte IE 8.0)]><!--><link type=text/css rel=stylesheet href="http://hi.bdimg.com/static/qhome/css/detail/20002/detail_datauri.css?v=58edb787.css"><!--<![endif]-->     <link rel=stylesheet type=text/css href="http://hi.bdimg.com/static/qpublish/css/editor/shCoreDefault.css?v=79e715f0.css">     <script src="http://hi.bdimg.com/static/qbase/js/qing/qing.js?v=058da7b0.js"></script>  <script>
/*最终页页面变量*/
window.detailPage = {
threadId : "9a852287bd2a062b110ef34a",
blogTitle: "数据库物理模型设计" || "无标题",
contentType : "text",
originAuthorName : "",
originPortrait : "",
originThreadId : ""
};
</script><script>wpo.head=new Date*1;</script> </head> <body>  <header class=mod-topbar id=modTopbar><iframe class=mod-topbar-bgframe></iframe><div class=mod-topbar-pseudo-real><div class="wrapper-box clearfix"><div class=left-box><a href="http://hi.baidu.com" class=logo-box><span id=baiduSpaceLogo class=q-logo></span></a></div> <div class=center-box><ul class=q-menubox>  <li class="q-menuitem q-newicon"> <a href=http://xiangce.baidu.com target=_blank>相册</a>  <li class="q-menuitem " id=qMenuRecommend><a href="http://hi.baidu.com/index/">广场</a></ul></div>  <div class=right-box><ul class=q-navbox><li class=q-navitem><a href="http://hi.baidu.com/go/login" class=q-goto-login>登录</a><li class="q-navitem q-nav-sp"><span></span><li class=q-navitem><a href="http://hi.baidu.com/go/reg?pmfrom=qingtop">注册</a> </ul><div class="right mod-qhome-follow-box"><a href="#" class="follow-btn a-btn-follow qing-stat-nsclick" data-nsclick=20121012follow_hdbtnaddcare>关注此空间</a></div> </div> </div></div></header>  <section class=mod-page-body> <div class="mod-page-main wordwrap clearfix">  <div class=x-page-container>    <section class="mod-topspaceinfo mod-cs-header"><div class=head-topbar></div><div class=container><h1><a class="space-name cs-header-spacename" href="/injava">inJava</a></h1><p class="space-description cs-header-spacesummary">J2EE、架构、搜索引擎、数据挖掘、互联网、创业、媒体、资料库</p></div><div class=head-footer></div></section>   <div class=mod-blogpage-wraper> <div class="blog-bg-main-repeat hide"></div>  <div class="grid-80 mod-blogpage"> <div class="blog-bg-main hide"></div>    <div class="mod-text-content mod-post-content mod-cs-contentblock"> <div class=cs-contentblock-bg></div>   <div class="content-head clearfix">  <div class=content-other-info>  <span>2010-03-06 11:13</span>  </div>   <h2 class="title content-title">数据库物理模型设计</h2>  </div>  <div id=content class="content mod-cs-content text-content clearfix"> <p>下面让我们来逐一介绍这四种主要设计模式：</p><p><strong>（一）主扩展模式</strong><br />主扩展模式，通常用来将几个相似的对象的共有属性抽取出来，形成一个“公共属性表”；其余属性则分别形成“专有属性表”，且“公共属性表”与“专有属性表”都是“一对一”的关系。<br />“专有属性表”可以看作是对“公共属性表”的扩展，两者合在一起就是对一个特定对象的完整描述，故此得名“主扩展模式”。<br />举例如下（注：这个例子已经作了相当程度的简化，仅仅是用来帮助大家理解“主扩展模式”这个概念来使用的，请大家注意）。<br />假设某公司包括如下6种类型的工作人员：采购员、营销员、库房管理员、收银员、财务人员和咨询专家，采用主扩展模式进行设计，如下图所示。</p><p>&#160;</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 无论哪种类型的工作人员，都要访问公司的办公软件，所以都有“登陆代码”和“登录密码”；并且作为一般属性，“姓名”、“性别”、“身份证号”、“入职时 间”、“离职时间”等属性，都与个人所从事的工作岗位无关，所以可以抽取出来作为公共属性，创建“公司员工”表。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 很显然，公司委派员工采购哪些商品是“采购员”的专有属性，这是由公司的实际业务特点决定的。换句话说，公司不可能把采购任务放到“营销员”身上，也不可能放到“库房管理员”身上，“采购商品”属性就是“采购员”的专用属性。<br />“采购员”表的主键与“公司员工”表的主键是相同的，包括字段名称和字段的实际取值；“采购员”表的主键同时是“公司员工”表主键的外键。在PDM图里可 以看到“采购员”表中的“员工ID”字段后面有一个“&lt;pk,fk&gt;”标记，这个标记就说明“员工ID”字段既是“采购员”表的主键，同时也 是该表的外键。<br />“公司员工”表是主表，“采购员”表是扩展表，二者是“一对一”的关系，两个表的字段合起来就是对“采购员”这个对象的完整说明。同理，“公司员工”表和其他5个表之间也都分别构成了“一对一”的关系。<br />对于主表来说，从表既可以没有记录，也可以有唯一一条记录来对主表进行扩展说明，这就是“主扩展模式”。</p><p>&#160;</p><p><strong>（二）主从模式</strong><br />主从模式，是数据库设计模式中最常见、也是大家日常设计工作中用的最多的一种模式，它描述了两个表之间的主从关系，是典型的“一对多”关系。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 举例如下（注：这个例子已经作了相当程度的简化，仅仅是用来帮助大家理解“主从模式”这个概念来使用的，请大家注意）。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 比如论坛程序。一个论坛通常都会有若干“板块”，在每个板块里面，大家可以发布很多的新帖。这时候“板块”和“发帖”就是主从模式，主表是“板块”，从表是“发帖”，二者是“一对多”的关系。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 多个潜水员也可以对感兴趣的同一份发帖进行回复，以表达各自的意见，这时候，一个“发帖”就有了多份“回复”，又构成了一个“主从模式”。</p><p><strong>（三）名值模式</strong><br />名值模式，通常用来描述在系统设计阶段不能完全确定属性的对象，这些对象的属性在系统运行时会有很大的变更，或者是多个对象之间的属性存在很大的差异。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 举例如下（注：这个例子已经作了相当程度的简化，仅仅是用来帮助大家理解“名值模式”这个概念来使用的，请大家注意）。</p><p>1.&#160;&#160;&#160;&#160;&#160;&#160; 使用名值模式进行设计时，如果对“其他属性”仅作浏览保存、不作其它任何特殊处理，则通常会设计一个“属性模板”表，该表的数据记录在系统运行时动态维护。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 系统运行时，如需维护“产品其他属性”，可先从“属性模板”中选择一个属性名称，然后填写“属性值”保存，系统会将对应的产品ID、属性模板ID及刚刚填 写的“属性值”一起保存在“产品其他属性”里，这样就完成了相关设置。无论产品的其他属性需求发生怎样的变化、怎样增删改属性，都可以在运行时实现，而不 必修改数据库设计和程序代码。（见下图）</p><p>&#160;</p><p>2.&#160;&#160;&#160;&#160;&#160;&#160; 使用名值模式进行设计时，如果对“其他属性”有特殊处理，比如统计汇总，那么这个属性名称需要在程序代码中作“硬编码”，即该属性名称需要在程序代码中有所体现，此时可以在“产品其他属性”表中直接记录“属性名称”，不再需要“属性模板”表。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 系统运行时，如需维护“产品其他属性”，程序直接列出“属性名称”，然后填写“属性值”保存，系统会将对应的产品ID、属性名称及刚刚填写的“属性值”一 起保存在“产品其他属性”里，这样就完成了相关设置。以后如果需求发生变更，则只需修改相应的程序代码即可，不必修改数据库设计。（见下图）</p><p><strong>（四）多对多模式<br /></strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 多对多模式，也是比较常见的一种数据库设计模式，它所描述的两个对象不分主次、地位对等、互为一对多的关系。对于A表来说，一条记录对应着B表的多条记录，反过来对于B表来说，一条记录也对应着A表的多条记录，这种情况就是“多对多模式”。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; “多对多模式”需要在A表和B表之间有一个关联表，这个关联表也是“多对多模式”的核心所在。根据关联表是否有独立的业务处理需求，可将其划分为两种细分情况。</p><p>1.&#160;&#160;&#160;&#160;&#160;&#160; 关联表有独立的业务处理需求。<br />举例如下（注：这个例子已经作了相当程度的简化，仅仅是用来帮助大家理解“多对多模式”这个概念来使用的，请大家注意）。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 比如网上书店，通常都会有“书目信息”和“批发单”。一条“书目信息”面对不同的购买客户、可以存在多张“批发单”，反过来，一张“批发单”也可以批发多 条书目，这就是多对多模式。中间的“批发单明细”表就是两者的关联表，具备独立的业务处理需求，是一个业务实体对象，因此它具备一些特有的属性，比如针对 每一条明细记录而言的“累计退货次数”、“累计退货数量”、“累计结算次数”、“累计结算数量”；由于批发单明细在数据产生后已经打印出纸质清单提供给客 户，因此在“批发单明细”表里对纸质清单中打印的书目信息属性作了冗余（逆标准化），这样在将来即使修改了“书目信息”表中的属性，也不会影响跟客户核对 批发单明细，不会影响未来的财务结算业务。</p><p>&#160;</p><p>2.&#160;&#160;&#160;&#160;&#160;&#160; 关联表没有独立的业务处理需求<br />举例如下（注：这个例子已经作了相当程度的简化，仅仅是用来帮助大家理解“多对多模式”这个概念来使用的，请大家注意）。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 比如用户与角色之间的关系，一般系统在做权限控制方面的程序时都会涉及到“系统用户表”和“系统角色表”。一个用户可以从属于多个角色，反过来一个角色里 面也可以包含多个用户，两者也是典型的“多对多关系”。其中的关联表“用户角色关联表”在绝大多数情况下都是仅仅用作表示用户与角色之间的关联关系，本身 不具备独立的业务处理需求，所以也就没有什么特殊的属性。</p><p><strong>（五）使用上述四种模式的一般原则</strong></p><p>1.&#160;&#160;&#160;&#160;&#160;&#160; 什么时候用“主扩展模式”？<br />对象的个数不多；各个对象之间的属性有一定差别；各个对象的属性在数据库设计阶段能够完全确定；各个扩展对象有独立的、相对比较复杂的业务处理需求，此时 用“主扩展模式”。将各个对象的共有属性抽取出来设计为“主表”，将各个对象的剩余属性分别设计为相应的“扩展表”，“主表”与各个“扩展表”分别建立一 对一的关系。<br /><br />2.&#160;&#160;&#160;&#160;&#160;&#160; 什么时候用“主从模式”？<br />对象的个数较多且不固定；各个对象之间的属性几乎没有差异；对象的属性在数据库设计阶段能够完全确定；各个对象没有独立的业务处理需求，此时用“主从模式”。将各个对象设计为“从表”的记录，与“主表”对象建立一对多的关系。<br /><br />3.&#160;&#160;&#160;&#160;&#160;&#160; 什么时候用“名值模式”？<br />对象的个数极多；各个对象之间的属性有较大差异；对象属性在数据库设计阶段不能确定，或者在系统运行时有较大变更；各个对象没有相互独立的业务处理需求，此时用“名值模式”。<br /><br />4.&#160;&#160;&#160;&#160;&#160;&#160; 什么时候用“多对多模式”？<br />两个对象之间互为一对多关系，则使用“多对多模式”。<br />数据库物理模型设计的其他模式</p><p>&#160;</p><p><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 除了上面提到的四种主要设计模式，还有一些其他模式，在某些项目中可能会用到，在这里先简单做个说明，暂不做深入讨论，等到以后的项目用到这些模式的时候，再结合实际需求详细解说。<br /></strong></p><p><strong>（一）继承模式</strong><br />继承模式，可以看作是“主从模式”的一种特殊情况（或者说是“变形”），它所代表的两个对象也是“一对多”的关系。它与“主从模式”的区别是，“继承模式”中从表的主键是复合主键，并且复合主键中必定包含主表的主键列。</p><p>根据从表继承主表的列的数量，继承模式又分以下两种情况：<br /><strong>1.&#160;&#160;&#160;&#160;&#160;&#160; 从表继承主表的全部列</strong><br /><br />在这种情况下，从表除了代表自身的专用字段以外，还冗余了主表的全部字段。这种设计方式的缺点显而易见：<br />数据冗余度大<br />一致性差<br />磁盘存储量大</p><p>它的优点也显而易见：<br />正因为它的冗余度大、所以它不易丢失数据。假设主表数据丢失、或者被误操作删改，也能依据从表数据重新生成主表数据；这种设计方式，可以在发生数据损坏的 时候从应用的角度进行一定程度的数据恢复，等于是在SQL Server数据库级别的数据恢复功能之上又加了一道保险。<br /></p><p>&#160;&#160;&#160;&#160;&#160;&#160; 正因为它一致性差、主表数据被重复存储，所以可依据外键关系进行数据验证。将主从表记录作关联比较，如果数据不一致，就可以得知数据要么被人为改动，或者要么程序代码中存在bug。</p><p>&#160;</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 尽管磁盘存储量大，但是数据在查询统计的时候，只需针对从表进行搜索即可，无需关联操作，可以加快检索的速度。这就是数据库模型设计中经常提到的“以空间换时间”。</p><p><strong>2.&#160;&#160;&#160;&#160;&#160;&#160; 从表只继承主表的主键列</strong><br /><br />这种设计方式，从表只继承了主表的主键列，这种方式的优缺点与前面刚好相反。</p><p>优点：<br />数据冗余度小<br />一致性高<br />磁盘存储量小</p><p>缺点：<br />正因为它的冗余度小、所以它易丢失数据。假设主表数据丢失、或者被误操作删改，就只能通过SQL Server数据库级别的数据恢复操作来找回丢失的数据了。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 正因为它一致性高，所以无法进行应用程序级的数据验证。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 由于采用了一致性设计，磁盘存储量较小，但是数据在查询统计的时候，必须要对两个表进行内连接（INNER JOIN）操作，才能搜索到相关数据。而内连接操作时需要耗费一定的时间的。这就是数据库模型设计中经常提到的“以时间换空间”。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 当然，在实际的数据库模型设计过程中，还会有介于上述两者之间的第3种情况出现，那就是从表继承了主表的主键列以及部分其他列。这就要求我们设计人员要依据实际的业务需求进行综合分析、权衡、折中，给出最符合业务需求的设计结果。<br /></p><p><strong>（二）自联结模式</strong><br />自联结模式，也可以看作是“主从模式”的一种特殊情况（或者说是“变形”），它在一张表内实现了“一对多关系”，并且可以根据业务需要实现“有限层”或者“无限层”的主从嵌套。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 这种模式用得最多的情况就是实现“树形结构”数据的存储，比如各大网站上常见的细分类别、应用系统的组织结构、Web系统的菜单树等都能用到这种模式。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 自联结模式有很多变体，且每种变体的优缺点同样鲜明。由于本连载的重点在于对跨行业通用数据库模型设计进行分析，所以对每种具体模式的细节方面的设计技巧不能作详细论述，请大家原谅。这里仅举两个例子说明：<br /><br />1.&#160;&#160;&#160;&#160;&#160;&#160; 简单自联结<br />简单自联结，就是在一个表里设置当前类ID、父类ID，同时规定最顶层类的父类ID为一个固定值（比如0），在生成树的时候使用递归算法，记录的前后顺序通过“排序号”字段来确定。</p><p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/liu7537/%E5%9B%BE9.jpg" alt="图9" /></p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 这个表用来存储菜单树很方便。首先会有一个主菜单，主菜单下有子菜单，子菜单下面又有孙菜单……菜单的数量不确定、层级不确定，用户可以在任意菜单下增加 新的子菜单，或者删除某个子菜单及其下的所有孙菜单……这种设计方式很多人都会用到，短小精悍、维护方便、且完全满足用户需求，而且树的层次不限，扩展起 来非常容易。这些都是它的优点。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 它的缺点就是树结构的生成由于使用了递归算法，必然要对该表进行多次读取（读取的次数 = 表内的记录数 – 最深层级的记录数），多次读取就来了比较低的运行效率，当表里的记录很多的时候，这个缺点可以称得上是致命的。<br />于是就有了下面的这种设计模式。</p><p>2.&#160;&#160;&#160;&#160;&#160;&#160; 扩展自联结<br />扩展自联结，与简单自联结的最大区别就是通过附加冗余字段来避免递归运算，所要实现的主要目标就是一次读取就能生成整个树，一次提高树的生成效率。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 但是，鱼与熊掌不可兼得，凡事都有两面性。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 生成树的效率提高了，增删改表内记录的算法就会相应复杂，并且树的层数也变为有限的了。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 所以在此类设计的时候，大家还是要认真分析业务需求，看看实际业务的重点在什么地方，然后再作具体设计。比如一些门户网站在首页显示产品类别是业务重点， 那么我们在设计的时候就要尽可能的提高生成树的效率，采取扩展自联结模式；相反，一些基于Web的业务系统，要求对菜单树的增删改维护操作尽量简单，由于 菜单的数目不多，所以菜单树的生成效率不是瓶颈，那么我们设计的时候就可以采取简单自联结模式。</p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 关于附加冗余字段实现扩展自联结的方法很多，网上也有很多这方面的帖子，大家可以到Google上搜一下。<br />在这里仅举一个例子如下：</p><p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/liu7537/%E5%9B%BE10.jpg" alt="图10" /></p><p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; 这个设计与前面的设计最大的区别就是排序字段，前面的简单自联结用了一个整数型的字段来实现排序，这里用了一个Varchar20型的字段“层级代码”来实现大排序。这个字段的取值两位一组，代表一层，假定最深为5层，初始值为0000000000。</p><p>按照这样的设计，表内的数据记录可能就是这样的： <br />ID&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeName&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ParentID&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeLevel<br />1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 根类别&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 000000<br />2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010000<br />3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010100<br />4&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1.2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010200<br />5&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 020000<br />6&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别2.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 5&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 020100<br />7&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 030000<br />8&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别3.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 7&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 030100<br />9&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别3.2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 7&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 030200<br />10&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1.1.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010101<br />……</p><p>现在按TypeLevel字段进行排序，执行如下SQL语句：SELECT * FROM TMP_Type ORDER BY TypeLevel<br />列出记录集如下：<br />ID&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeName&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ParentID&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeLevel<br />1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 总类别&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 000000<br />2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010000<br />3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010100<br />10&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1.1.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010101<br />4&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别1.2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 010200<br />5&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 020000<br />6&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别2.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 5&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 020100<br />7&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别3&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 030000<br />8&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别3.1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 7&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 030100<br />9&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 类别3.2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 7&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 030200<br />……<br />在控制显示类别的层次时，只要对“层级代码”字段中的数值进行判断，每2位一组，如大于0则向右移2个空格。</p> </div>    <div class="mod-tagbox clearfix">   <a class="tag" href="/tag/%E6%95%B0%E6%8D%AE%E5%BA%93/feeds">#数据库</a>  </div> <div class="mod-post-info clearfix">  <div class=x-bdshare>  <div id=bdshare class="bdshare_t bds_tools get-codes-bdshare" data="{'wbuid':1727466295}"> <span class=bds_more>分享到：</span> <a class=bds_qzone></a> <a class=bds_tsina></a> <a class=bds_tqq></a> <a class=bds_renren></a> </div> <script id=bdshare_js data="type=tools&amp;uid=713670"></script> <script id=bdshell_js></script> <script>
var bds_config = {'bdTop':240};
     var all_img = qing.g('content').getElementsByTagName('img');
if(all_img.length>0){
 bds_config.bdPic = all_img[0].src;
}
 document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?v=64287964.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script> </div> <div class="op-box mod-cs-opBox">  <a class="report-btn hide" target=_blank href="#"> 举报 </a>  <span class=pv>浏览(718)</span> <a class=comment-bnt id=commentBnt href="#" onclick="return false"> 评论<span class=comment-nub></span> </a>   <a href="#" id=shareBnt onclick="return false" class=share-bnt> 转载<span id=shareNub class=share-nub></span> </a>   </div> </div>   </div>    <div class=mod-share-detail id=shareDetail style=display:none></div>   <div class=mod-relate-blogs id=relateBlog> <h3 class=relate-title>你可能也喜欢</h3> <ul class="relate-blog-list clearfix">   <li  class=first > <a href="http://hi.baidu.com/yzytzhousl/item/ec0aca027bd0372ef2eafc57" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://b.hiphotos.baidu.com/space/scrop=90/sign=a9dc60ff9e3df8dca263c8cebd2c4bbb/279759ee3d6d55fb6be8182e6c224f4a20a4dd88.jpg" class=relate-img alt="美国黄石公园（7） 野火烧不尽的森林之木" title="美国黄石公园（7） 野火烧不尽的森林之木"> </a> <a href="http://hi.baidu.com/yzytzhousl/item/ec0aca027bd0372ef2eafc57" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>美国黄石公园（7） 野火烧不尽的森林之木</a>    <li > <a href="http://hi.baidu.com/crq64318423/item/3c40b633c86818a4b611db55" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://d.hiphotos.baidu.com/space/scrop=90/sign=bf36ce191c950a7b716b099b7aec5be9/f2deb48f8c5494ee03219a362cf5e0fe99257e9a.jpg" class=relate-img alt="新昌大佛 佛在心中  2013.3.15" title="新昌大佛 佛在心中  2013.3.15"> </a> <a href="http://hi.baidu.com/crq64318423/item/3c40b633c86818a4b611db55" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>新昌大佛 佛在心中  2013.3.15</a>    <li > <a href="http://hi.baidu.com/514321020/item/d4eeca41a201b8eda4c06603" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://d.hiphotos.baidu.com/space/scrop=90/sign=51b0d2120cf431adb88c04663b0b959f/34fae6cd7b899e51ecb40d9442a7d933c8950d73.jpg" class=relate-img alt="踏雪寻梅 十大赏梅地点推荐" title="踏雪寻梅 十大赏梅地点推荐"> </a> <a href="http://hi.baidu.com/514321020/item/d4eeca41a201b8eda4c06603" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>踏雪寻梅 十大赏梅地点推荐</a>    <li > <a href="http://hi.baidu.com/551107/item/7b133d2f8902ee1a2b0f1c62" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://f.hiphotos.baidu.com/space/scrop=90/sign=b17e6672d788d43ff4f7d6ad0d23eb2b/730e0cf3d7ca7bcb473b0628bf096b63f624a871.jpg" class=relate-img alt="悠闲美国游－－(7) 假若老祖宗不去卖坛坛罐罐" title="悠闲美国游－－(7) 假若老祖宗不去卖坛坛罐罐"> </a> <a href="http://hi.baidu.com/551107/item/7b133d2f8902ee1a2b0f1c62" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>悠闲美国游－－(7) 假若老祖宗不去卖坛坛罐罐</a>    <li > <a href="http://hi.baidu.com/easy2get/item/9ecd261b711a5c5b2a3e22d4" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://a.hiphotos.baidu.com/space/scrop=90/sign=c1740939203fb80e088f268846ec161e/72f082025aafa40f8b66cbd5aa64034f78f01911.jpg" class=relate-img alt="岁末游轮之旅（13）：拿骚之美食" title="岁末游轮之旅（13）：拿骚之美食"> </a> <a href="http://hi.baidu.com/easy2get/item/9ecd261b711a5c5b2a3e22d4" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>岁末游轮之旅（13）：拿骚之美食</a>    <li > <a href="http://hi.baidu.com/shijian2012/item/d6d68611597361081994ecaf" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://d.hiphotos.baidu.com/space/scrop=90/sign=be58ba1e4710b912bb9fb1a1b3c0c533/6c224f4a20a446237abe58c79822720e0cf3d71b.jpg" class=relate-img alt="海上印象，老城隍庙一瞥" title="海上印象，老城隍庙一瞥"> </a> <a href="http://hi.baidu.com/shijian2012/item/d6d68611597361081994ecaf" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>海上印象，老城隍庙一瞥</a>    <li > <a href="http://hi.baidu.com/injava/item/6a46a93dab53bb0ecfb9fe4a" target=_blank class=qing-stat-nsclick data-nsclick=m_20121105_detail_relates_img> <img src="http://g.hiphotos.baidu.com/space/scrop=90/sign=ef3e3da0b80e7bec278444be5f138008/83025aafa40f4bfb2dd2b7fb034f78f0f736181a.jpg" class=relate-img alt="亚马逊是这样改造卓越的：由系统匹配最佳仓库" title="亚马逊是这样改造卓越的：由系统匹配最佳仓库"> </a> <a href="http://hi.baidu.com/injava/item/6a46a93dab53bb0ecfb9fe4a" target=_blank class="relate-txt qing-stat-nsclick" data-nsclick=m_20121105_detail_relates_txt>亚马逊是这样改造卓越的：由系统匹配最佳仓库</a>   </ul> </div>   <div class="mod-detail-pager clearfix">  <div class=detail-nav-pre> <a href="http://hi.baidu.com/injava/item/c40fcbd71c55fb2838f6f74a" hidefocus title="上一篇"></a> </div>   <div class=detail-nav-next> <a href="http://hi.baidu.com/injava/item/2a86a513c8745b9e98ce334c" hidefocus title="下一篇"></a> </div>  </div>   <div id=commentDetail class="mod-comment-detail clearfix mod-cs-comment">   <div class=mod-recent-readers> <h3 class=recent-readers-title>本文最近访客</h3> <ul class="readers-list clearfix">    <li  class=first > <a target=_blank href="http://hi.baidu.com/frogoscar"> <img src="http://hiphotos.baidu.com/space/scrop%3D65%3Bq%3D100/sign%3Df653ac7f912397ddd227df5b29bf8482/09fa513d269759eeae06f553b2fb43166c22dfd0.jpg" title="Oscar" alt="Oscar" class=portrait> </a> <a target=_blank href="http://hi.baidu.com/frogoscar" class=user-name title="Oscar"> Oscar </a> <div class=visit-time data-visit-time="1354196367"></div>    </ul> </div>  <div class=comment-title>评论</div> <div class=comment-content></div> </div>   </div>  </div>  </div> </div> </section>  <footer class="mod-footer mod-cs-footer"><div class="clearfix hidden-box"></div><div class=footer-box><div class=inner-box><a href=http://help.baidu.com/question?prod_en=hi target=_blank>帮助中心</a><span>&nbsp;|&nbsp;</span><a href=http://tieba.baidu.com/p/1781683739 target=_blank>空间客服</a><span>&nbsp;|&nbsp;</span><a href=http://tousu.baidu.com/hi/add target=_blank>投诉中心</a><span>&nbsp;|&nbsp;</span><a href=http://www.baidu.com/search/hi_contract.html target=_blank>空间协议</a></div><div class=copy-box>&copy;2013&nbsp;Baidu</div></div></footer>  <script src="http://hi.bdimg.com/static/qbase/js/mod/mod_foot.js?v=b9c41b0e.js"></script> <script>
qing.dom.ready(function(){
 if (qVisitorInfo.loginStatus == 'activated'){
     qext.stat.ns('m_20121012_loga_num');
qext.fn.setStoken();
}
});
</script>        <script>qext.stat.ns('m_20120425_20002');</script>  <script src="http://hi.bdimg.com/static/qcomment/js/qcmt_import.js?v=ac96f988.js"></script>  <script src="http://hi.bdimg.com/static/qpublish/js/editor/shCore.js?v=bcf5a2e1.js"></script> <script>
SyntaxHighlighter.highlight();
</script>   <script src="http://hi.bdimg.com/static/qhome/js/detail/20001/detail.js?v=7ff54b94.js"></script>   <script>wpo.tti=new Date*1;</script><script src="http://hi.baidu.com/cm/static/js/allsite.js?v=64181424.js?v=201303290940"></script><script>document.write(unescape("%3Cscript src='http://hm.baidu.com/h.js%3F8c869b543955d43e496c2efee5b55823' type='text/javascript'%3E%3C/script%3E"));qext.stat.ns('m_20120713_qing_pv');</script>